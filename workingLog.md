## 2025/4/18 

### 已完成工作
1. 完成專案項目流程圖
   - 設計並確認整體婚禮邀請函生成系統的流程
   - 確認使用者操作與系統回饋流程

2. 完成前端架設
   - 使用 React + TypeScript + Vite 建立專案架構
   - 實現多頁面導航與表單操作
   - 設計並實現邀請函編輯與預覽功能
   - 完成賓客資料管理介面

3. 完成後端架設
   - 使用 Node.js + Express 建立 API 服務
   - 設計並實現資料庫 Schema (使用 SQLite + Prisma)
   - 建立 REST API 端點並完成與前端整合
   - 實現日誌系統與錯誤處理機制
   - 增加系統健康檢查 API
   - 整合 DeepSeek AI 模型

4. 完成主要code的詳細註解
   - 為前端React組件添加功能說明與使用說明
   - 為後端中間件添加詳細實現邏輯註解
   - 完善API端點與控制器的功能說明
   - 為安全、日誌和監控模組添加完整註解
   - 為資料庫模型與Schema添加結構說明

### 待解決問題(約一天時間)
1. **新人基本資料儲存問題**
   - 錯誤現象：無法保存資料，出現「請稍後再試」錯誤提示
   - 檢查方案：查看錯誤日誌文件
     - SQL日誌: `wedding-invitation-generator/backend/logs/combined.log`
     - 錯誤日誌: `wedding-invitation-generator/backend/logs/error.log`
   - 查看方法：
     - 直接開啟日誌文件: `notepad logs/error.log`
     - 使用日誌查看工具: `node scripts/viewSqlLogs.js`
     - 使用命令行過濾: `findstr "error" logs/combined.log`

2. **伺服器啟動問題**
   - 錯誤現象：bat檔案無法開啟瀏覽至http://localhost:5000的伺服器
   - 可能原因：
     - 端口5000被其他應用佔用
     - 伺服器啟動過程中出現錯誤
     - 資料庫連接問題
   - 檢查方法：
     - 查看進程佔用: `netstat -ano | findstr :5000`
     - 手動啟動伺服器: `cd backend && npm start`
     - 檢查伺服器日誌: `logs/combined.log`

---

## 2025/4/19

### 已解決問題

1. **新人基本資料儲存問題**
   - 問題原因：後端伺服器未正確啟動，根本原因是前後端 API 路徑不一致
   - 解決方法：修正前端 `api.ts` 中的 API 請求路徑，使其與後端 router 中定義的路徑保持一致
   - 技術細節：確保前後端路由匹配，讓前端請求能正確到達後端處理函數

2. **邀請函編輯功能問題**
   - 問題現象：編輯邀請函時無法根據使用者反饋重新生成內容，而是直接附加在原內容後面
   - 解決方法：重新設計 `handleSaveInvitationFeedback` 函數，將使用者反饋作為參數傳遞給後端 API
   - 技術細節：
     - 修改 `api.ts` 中的 `invitations.update` 方法，增加可選的 `feedbackText` 參數
     - 更新 `PreviewPage.tsx` 中的反饋處理邏輯，使反饋信息傳遞至後端用於 DeepSeek AI 重新生成

3. **賓客重複問題**
   - 問題現象：從邀請函預覽頁返回賓客資料頁時，賓客數據自動複製（例如：一個林黛玉變成兩個）
   - 解決方法：修正 React 狀態管理邏輯，防止在頁面導航時重複添加賓客數據
   - 技術細節：檢查並修正 reducer 處理函數中可能導致重複的邏輯

4. **郵件發送錯誤問題**
   - 問題現象：發送邀請函時出現認證錯誤 "Invalid login: 535-5.7.8 Username and Password not accepted"
   - 解決方法：修正 SMTP 配置，更新正確的郵件帳號憑證
   - 到Google 帳戶新增應用程式密碼至env檔案

### 後續待處理問題

1. **UI 優化需求**
   - 已修改：在 ConfirmationPage 中移除每個賓客的個別發送按鈕，改為只使用批量發送功能
   - 待處理：將邀請函文字顏色調整為全黑，提高可讀性

2. **Markdown 支持**
   - 需求：在預覽邀請函時啟用 Markdown 語法渲染，並在最終郵件輸出時也應用相同的 Markdown 效果
   - 實施方案：整合 Markdown 解析庫（如 marked.js）到邀請函預覽和郵件模板中

3. **邀請函生成流程優化**
   - 當前情況：系統會自動為選中的賓客生成邀請函
   - 確認：維持現有流程，無需修改

4. **批量發送問題**
   - 問題現象：最終確認時出現「輸入資料有誤」錯誤，無法發送郵件
   - 問題詳情：成功發送後顯示「已成功發送 undefined 封邀請函」而非正確數量
   - 臨時解決方案：移除 alert 訊息顯示
   - 根本原因分析：
     - 在 `emailRoutes.js` 中的 `/send` 路由需要 `coupleInfoId` 參數進行驗證
     - 前端 `api.ts` 中的 `sendAll` 方法未正確傳遞此參數

5. **資料庫遷移問題**
   - 問題：可能因資料庫遷移（migrate）導致 DeepSeek 生成的結果無法正確儲存和顯示
   - 調查方向：檢查 Prisma Schema 和資料庫遷移記錄，確保模型定義與實際資料庫結構匹配

6. **部署與分享**
   - 任務：完成系統部署，使組員能夠使用系統
   - 計畫：準備詳細的部署文檔和使用說明

